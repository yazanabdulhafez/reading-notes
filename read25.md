# Espresso

Espresso is used to write a test for Android UI.
Espresso tests run very fast

## Target audience

The target for Espresso is the developers who believe in the testing as a part of life cycle of development.

## Synchronization capabilities

When onView() invoked Espresso waits to perform an action until the synchronization conditions are met which are:

1. The message queue is empty.
2. There are no instances of AsyncTask currently executing a task.
3. All developer-defined idling resources are idle.

by these conditions it make the test results more reliable and dependable.

## Packages

Espresso need the following packages:

* `espresso-core`
* `espresso-web`
* `espresso-idling-resource`
* `espresso-contrib`
* `espresso-intents`
* `espresso-remote`

## Create UI tests with Espresso Test Recorder

Espresso Test allow us to create UI tests without writing any testing code.

### Record an Espresso test

Espresso tests consist of two primary components:

1. UI interactions.
2. assertions on View elements.

### Record UI interactions

To start recording a test with Espresso:

1. Click Run > Record Espresso Test.
2. In the Select Deployment Target window, choose the device on which you want to record the test then Click OK.

### Add assertions to verify UI elements

* Types of verifying the existence or contents of a View element by assertion:

1. text is: Checks the text content of the selected View element
2. exists: Checks that the View element is present in the current View hierarchy visible on the screen
3. does not exist: Checks that the View element is not present in the current View hierarchy

* To add an assertion to your test, proceed as follows:

1. Click Add Assertion.
2. To select a View element on which to create an assertion, click on the element in the screenshot or use the first drop-down menu in the Edit assertion box in bottom of page.
3. Select the assertion.
4. Click Save and Add Another to create another assertion or click Save Assertion to close the assertion panels.

### Save a recording

1. Click Complete Recording. The Pick a test class name for your test window appears.
2. from pick name for the test you can choose the default name or you can change it then Click Save.
If there is a Missing Espresso dependencies an dialog appears when you try to save your test. Click Yes to automatically add the dependencies to your build.gradle file.

## Run an Espresso test locally

Using the  Project  window on the left side of the Android Studio IDE:

* Open the desired app module folder and navigate to the test you want to run.

1. If you are using the Android view within the window, navigate to java > com.example.username.appname (androidTest).
2. If you are using the Project view inside the window, navigate to src > androidTest > java > com.example.username.appname within the module folder.

* Right-click on the test and click Run ‘testName.’

* In the Select Deployment Target window, choose one device to run the test on then Click OK.

## Run an Espresso test with Firebase Test Lab for Android

we can use the tests generated by Espresso to test the application on different devices configurations.

## Resources used in this reading

1. [Espresso](https://developer.android.com/training/testing/espresso#target-audience)
2. [Create UI tests with Espresso Test Recorder](https://developer.android.com/studio/test/espresso-test-recorder#turn-off-animations-on-your-test-device)
